# Global agent configuration
[agent]
  interval = "1m"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "10s"
  flush_jitter = "0s"
  precision = ""
  debug = true
  quiet = false
  logfile = ""
  hostname = ""
  omit_hostname = false

[[inputs.exec]]
  commands = ["python3 catalyst_center_site_health.py"]  # Replace with the command that outputs this JSON
  timeout = "30s"
  data_format = "json_v2"

  [[inputs.exec.json_v2]]
    measurement_name = "catalyst_center_site_health"

    [[inputs.exec.json_v2.object]]
      path = "@flatten"
      tags = ["siteName", "siteId", "parentSiteId", "parentSiteName", "siteType"]

      [inputs.exec.json_v2.object.fields]
        healthyNetworkDevicePercentage = "float"
        healthyClientsPercentage = "float"
        clientHealthWired = "float"
        clientHealthWireless = "float"
        numberOfClients = "int"
        numberOfNetworkDevice = "int"
        networkHealthAverage = "float"
        networkHealthAccess = "float"
        networkHealthCore = "float"
        networkHealthDistribution = "float"
        networkHealthRouter = "float"
        networkHealthAP = "float"
        networkHealthWLC = "float"
        networkHealthSwitch = "float"
        networkHealthWireless = "float"
        networkHealthOthers = "float"
        numberOfWiredClients = "int"
        numberOfWirelessClients = "int"
        totalNumberOfConnectedWiredClients = "int"
        totalNumberOfActiveWirelessClients = "int"
        wiredGoodClients = "int"
        wirelessGoodClients = "int"
        overallGoodDevices = "int"
        accessGoodCount = "int"
        accessTotalCount = "int"
        coreGoodCount = "int"
        coreTotalCount = "int"
        distributionGoodCount = "int"
        distributionTotalCount = "int"
        routerGoodCount = "int"
        routerTotalCount = "int"
        wirelessDeviceGoodCount = "int"
        wirelessDeviceTotalCount = "int"
        apDeviceGoodCount = "int"
        apDeviceTotalCount = "int"
        wlcDeviceGoodCount = "int"
        wlcDeviceTotalCount = "int"
        switchDeviceGoodCount = "int"
        switchDeviceTotalCount = "int"
        applicationHealth = "float"
        applicationGoodCount = "int"
        applicationTotalCount = "int"
        applicationBytesTotalCount = "int"

    [[inputs.exec.json_v2.object]]
      path = "#.applicationHealthStats"

      [inputs.exec.json_v2.object.fields]
        appTotalCount = "int"
        businessIrrelevantAppCount_fair = "int"
        businessIrrelevantAppCount_good = "int"
        businessIrrelevantAppCount_poor = "int"
        businessRelevantAppCount_fair = "int"
        businessRelevantAppCount_good = "int"
        businessRelevantAppCount_poor = "int"
        defaultHealthAppCount_fair = "int"
        defaultHealthAppCount_good = "int"
        defaultHealthAppCount_poor = "int"

# Output configuration for InfluxDB v2
[[outputs.influxdb_v2]]
  urls = ["http://localhost:8086"]
  token = "ekRJMuWCSQkn8VIFLXd-cPbogtypMLnYTOhRvaQfuJHs7pdNmkhTOKOjQ8IVerfKVjQX8qlGAXwRKlLUPHGvgQ=="
  organization = "test"
  bucket = "cat"